
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ì œì—­í’ê²½ì±„ì–´ë°”ë‹ˆí‹°_2BL ë“±ê¸°ë¹„ìš© ëª¨ì˜ê³„ì‚°ê¸°</title>
    <style>
        :root { --primary-color: #1a5d3b; --accent-color: #0984e3; --red-color: #d63031; }
        body { font-family: 'Pretendard', sans-serif; line-height: 1.1; color: #333; max-width: 480px; margin: 0 auto; padding: 10px; background: #f4f7f6; font-size: 14px; }
        h1 { text-align: center; color: var(--primary-color); font-size: 1.3em; margin: 5px 0 12px 0; font-weight: 900; }
        input, select { width: 100%; padding: 6px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.95em; font-weight: 600; text-align: right; box-sizing: border-box; }
        .row { display: flex; gap: 5px; margin-bottom: 5px; align-items: center; }
        label { font-weight: bold; font-size: 0.8em; white-space: nowrap; color: #444; }
        .price-header { background: var(--primary-color); color: #fff; padding: 10px; border-radius: 6px; margin-bottom: 8px; }
        .p-row { display: flex; justify-content: space-between; margin-bottom: 3px; align-items: center; }
        .p-val { font-weight: bold; color: #f1c40f; }
        .opt-row { display: flex; gap: 5px; margin-bottom: 4px; align-items: center; background: #eaf2f8; padding: 5px; border-radius: 4px; }
        .opt-net { font-size: 0.75em; color: var(--accent-color); font-weight: bold; min-width: 80px; text-align: right; }
        .tax-base-box { background: #fff; border: 2.5px solid #d35400; padding: 10px; border-radius: 6px; margin: 8px 0; text-align: center; color: #d35400; font-weight: 900; }
        .res-box { border: 2px solid var(--primary-color); border-radius: 8px; padding: 12px; background: #fff; }
        .res-item { display: flex; justify-content: space-between; margin-bottom: 3px; border-bottom: 1px dashed #eee; padding-bottom: 2px; font-size: 0.9em; }
        .total-row { display: flex; justify-content: space-between; margin-top: 8px; padding-top: 8px; border-top: 2px solid var(--red-color); color: var(--red-color); font-size: 1.35em; font-weight: 900; }
        .action { cursor: pointer; border: none; border-radius: 4px; padding: 10px; font-weight: bold; color: white; background: #444; flex: 1; }
    </style>
</head>
<body>
    <h1>ğŸŒ±ğŸ‚ì§€ì œì—­ë°˜ë„ì²´ë°¸ë¦¬í’ê²½ì±„ì–´ë°”ë‹ˆí‹°2BL<br>ë“±ê¸°ë¹„ìš© ëª¨ì˜ê³„ì‚°ê¸°(ğŸ‘ŒëŒ€ëµ ì‚°ì¶œìš©)</h1>
    <div class="row"><input type="number" id="dong" placeholder="ë™" oninput="upd()"> <label>ë™</label><input type="number" id="ho" placeholder="í˜¸" oninput="upd()"> <label>í˜¸</label></div>
    <div class="price-header">
        <div class="p-row"><span>ë¶„ì–‘ê°€ ê°€ì•¡ <small id="tyTxt"></small></span><span class="p-val" id="mPrice">0 ì›</span></div>
        <div class="p-row"><span>ë°œì½”ë‹ˆ í™•ì¥ë¹„ (ìˆœì•¡ ìë™ê³„ì‚°)</span><div style="text-align:right;"><div id="bPrice_total" style="font-size:1em; font-weight:bold;">0 ì›</div><div id="bPrice_net" style="font-size:0.85em; color:#f1c40f;">ìˆœì•¡: 0 ì›</div></div></div>
    </div>
    <div id="optContainer"></div>
    <button onclick="addOpt()" style="width:100%; padding:8px; background:var(--accent-color); color:white; border:none; border-radius:4px; font-weight:bold; margin-bottom:8px;">+ ìœ ìƒì˜µì…˜ ì¶”ê°€</button>
    <div class="row" style="gap:10px;"><div style="flex:1; display:flex; align-items:center; gap:5px;"><label>7%ì„ ë‚©í• ì¸</label><input type="text" id="prepay" style="color:red;" value="0" oninput="fCalc(this)"></div><div style="flex:1.2; display:flex; align-items:center; gap:3px;"><label>P/ë§ˆí”¼</label><select id="pSign" onchange="calc()" style="width:80px;"><option value="1">+</option><option value="-1">-</option></select><input type="text" id="prem" style="color:red;" value="0" oninput="fCalc(this)"></div></div>
    <div class="row"><label>ëŒ€ì¶œê¸ˆì•¡</label><input type="text" id="loan" value="0" oninput="fCalc(this)"><label style="font-size:0.7em;">ì„¤ì •</label><select id="lRate" onchange="calc()" style="width:90px;"><option value="1.2">120%</option><option value="1.1">70%</option><option value="1.3">130%</option></select><label style="font-size:0.7em;">í• ì¸ìœ¨%</label><input type="number" id="bRate" value="13.00" step="0.01" style="width:70px;" oninput="calc()"><a href="https://okbfex.kbstar.com/quics?page=C028010#CP" target="_blank" style="font-size:0.7em; color:blue; font-weight:bold; text-decoration:none;">[ì¡°íšŒ]</a></div>
    <div class="row" style="background:#e9ecef; padding:8px; border-radius:4px;"><div style="flex:1.5;"><label style="display:block; font-size:0.75em;">ìˆ˜ì…ì¸ì§€(ë“±ê¸°) ì„ íƒ</label><select id="sSel" onchange="calc()"><option value="150000">ì›ë¶„ì–‘ì(15ë§Œ)</option><option value="300000">ì „ë§¤1íšŒ(30ë§Œ)</option><option value="450000">ì „ë§¤2íšŒ(45ë§Œ)</option><option value="0">ì´ë¯¸êµ¬ë§¤</option></select></div><div style="flex:1; text-align:right;"><label style="display:block; font-size:0.75em;">ì¸ì§€(ëŒ€ì¶œ) 50%</label><input type="text" id="rLS_disp" readonly style="border:none; color:red; background:none; padding:0; height:auto; font-weight:bold;" value="0 ì›"></div></div>
    
    <div class="tax-base-box">ğŸ’° ì·¨ë“ì„¸ ê³¼ì„¸í‘œì¤€ì•¡<br><span id="finalTaxBase" style="font-size:1.4em;">0 ì›</span></div>
    
    <div class="res-box">
        <div class="res-item"><span>ì·¨ë“ì„¸ (êµìœ¡ì„¸ í¬í•¨)</span><span id="rTax" style="font-weight:bold;">0 ì›</span></div>
        <div class="res-item"><span>ì±„ê¶Œ í• ì¸ë£Œ í•©ê³„</span><span id="rBondTot">0 ì›</span></div>
        <div class="res-item"><span>ìˆ˜ì…ì¸ì§€ì„¸ í•©ê³„</span><span id="rAllS">0 ì›</span></div>
        <div class="res-item"><span>ê¸°íƒ€ ì‹¤ë¹„</span><span>59,000 ì›</span></div>
        <div class="total-row"><span>ğŸ’ ì˜ˆìƒ ë“±ê¸° ë¹„ìš©(around)</span><span id="rTot">0 ì›</span></div>
        <div style="text-align:center; margin-top:5px;"><button onclick="tglD()" style="background:none; border:none; color:#666; font-size:0.7em; cursor:pointer; text-decoration:underline;">[ìƒì„¸ ì‚°ì¶œê·¼ê±° ë° ìˆ˜ì‹ ë³´ê¸°]</button></div>
        <div id="tD" style="display:none; font-size:0.85em; background:#f9f9f9; padding:10px; border:1px solid #ddd; margin-top:10px; white-space:pre-line; text-align:left;"></div>
    </div>
    <div class="row" style="margin-top:10px;">
        <button class="action" style="background:#2980b9;" onclick="sendMail()">ë©”ì¼ ë³´ë‚´ê¸°</button>
        <button class="action" onclick="window.print()">ì¸ì‡„í•˜ê¸°</button>
    </div>

<script>
const pData = {'84':{1:433000000,2:445000000,3:459000000,4:469000000,5:478000000,bA:19500000,bB:19900000},'103':{1:{t:520000000,v:28808000},2:{t:537000000,v:29749800},3:{t:554000000,v:30691600},4:{t:566000000,v:31356400},5:{t:576000000,v:31910400},b:23000000}};

function n(v){ return parseInt(v.toString().replace(/[^0-9-]/g,''))||0; }
function f(v){ return v.toLocaleString(); }
function fCalc(el){ el.value=f(n(el.value)); calc(); }

function addOpt(){
    const div=document.createElement('div'); div.className='opt-row';
    div.innerHTML=`<input type="text" placeholder="í•­ëª©" style="text-align:left; flex:1; padding:4px;"><input type="text" class="o-p" value="0" oninput="fCalc(this)" style="width:140px; padding:4px;"><div class="opt-net">ìˆœ: 0</div><button onclick="this.parentElement.remove();calc()" style="border:none; background:none; color:red; font-weight:bold; cursor:pointer;">X</button>`;
    document.getElementById('optContainer').appendChild(div);
}

function upd(){
    const d=document.getElementById('dong').value, h=n(document.getElementById('ho').value);
    if(!d||h<101)return;
    let fl=Math.floor(h/100); if(fl>5)fl=5;
    let ty=(['201','205','209'].includes(d))?"103":((h%100===2&&!['204','208','212'].includes(d))?"84B":"84A");
    let mp=(ty==="103")?pData['103'][fl].t:pData['84'][fl];
    let bp=(ty==="84A")?pData['84'].bA:(ty==="84B"?pData['84'].bB:pData['103'].b);
    document.getElementById('tyTxt').innerText=`(${ty}íƒ€ì…)`;
    document.getElementById('mPrice').innerText=f(mp)+" ì›";
    document.getElementById('bPrice_total').innerText=f(bp)+" ì›";
    document.getElementById('bPrice_net').innerText="ìˆœì•¡: "+f(Math.floor(bp/1.1))+" ì›";
    calc();
}

function calc(){
    const h=n(document.getElementById('ho').value); if(h<101)return;
    let ty=document.getElementById('tyTxt').innerText.includes("103")?"103":"84";
    let fl=Math.floor(h/100); if(fl>5)fl=5;
    let mp=(ty==="103")?(pData['103'][fl].t-pData['103'][fl].v):pData['84'][fl];
    let bp_net=Math.floor(n(document.getElementById('bPrice_total').innerText)/1.1);
    let opt_net=0; 
    document.querySelectorAll('.opt-row').forEach(row=>{ 
        let val=n(row.querySelector('.o-p').value); 
        let net=Math.floor(val/1.1); 
        opt_net+=net; 
        row.querySelector('.opt-net').innerText="ìˆœ: "+f(net); 
    });
    let prepay=n(document.getElementById('prepay').value), pSign=n(document.getElementById('pSign').value), prem=n(document.getElementById('prem').value)*pSign;
    let tBase=mp+bp_net+opt_net-prepay+prem;
    document.getElementById('finalTaxBase').innerText=f(tBase)+" ì›";
    let tax=Math.floor((tBase*(ty==="103"?0.013:0.011))/10)*10;
    let buyBond=Math.round((tBase*0.021)/10000)*10000, loan=n(document.getElementById('loan').value), lRate=parseFloat(document.getElementById('lRate').value);
    let maxL=Math.floor(loan*lRate), loanBond=Math.round((maxL*0.01)/10000)*10000, br=parseFloat(document.getElementById('bRate').value)/100;
    let bD=Math.floor(buyBond*br), lD=Math.floor(loanBond*br), ls=(loan>100000000)?75000:(loan>50000000?35000:0), sB=n(document.getElementById('sSel').value);
    document.getElementById('rTax').innerText=f(tax)+" ì›"; 
    document.getElementById('rBondTot').innerText=f(bD+lD)+" ì›";
    document.getElementById('rLS_disp').value=f(ls)+" ì›"; 
    document.getElementById('rAllS').innerText=f(sB+ls)+" ì›";
    document.getElementById('rTot').innerText=f(tax+bD+lD+sB+ls+59000)+" ì›";
    document.getElementById('tD').innerText=`1. ê³¼í‘œ ì‚°ì¶œ: ë¶„ì–‘ê°€(${f(mp)})+ë°œì½”ë‹ˆìˆœ(${f(bp_net)})+ì˜µì…˜ìˆœ(${f(opt_net)})-í• ì¸(${f(prepay)})+P(${f(prem)}) = ${f(tBase)}ì›\n2. ì·¨ë“ì„¸: ê³¼í‘œ Ã— ${ty==="103"?"1.3%":"1.1%"} = ${f(tax)}ì›\n3. ì±„ê¶Œ(í• ì¸ìœ¨ ${br*100}%): ì´ì „(${f(buyBond)}ì› ë§¤ì…)+ëŒ€ì¶œ(${f(loanBond)}ì› ë§¤ì…) = ì´ ${f(bD+lD)}ì› ì†Œìš”\n4. ìˆ˜ì…ì¸ì§€: ë“±ê¸°(${f(sB)}ì›)+ëŒ€ì¶œ(${f(ls)}ì›) = ${f(sB+ls)}ì›`;
}

function sendMail() {
    const dong = document.getElementById('dong').value;
    const ho = document.getElementById('ho').value;
    const taxBase = document.getElementById('finalTaxBase').innerText;
    const total = document.getElementById('rTot').innerText;
    const tax = document.getElementById('rTax').innerText;
    const bond = document.getElementById('rBondTot').innerText;
    const stamp = document.getElementById('rAllS').innerText;
    const detail = document.getElementById('tD').innerText;

    let mailBody = `ğŸ  [ì§€ì œì—­í’ê²½ì±„ì–´ë°”ë‹ˆí‹° 2BL ë“±ê¸°ë¹„ìš© ê³„ì‚° ê²°ê³¼]\n`;
    mailBody += `----------------------------------------------\n`;
    mailBody += `ğŸ“ ëŒ€ìƒ: ${dong || ' '}ë™ ${ho || ' '}í˜¸\n`;
    mailBody += `ğŸ’° ìµœì¢… ì·¨ë“ì„¸ ê³¼ì„¸í‘œì¤€ì•¡: ${taxBase}\n`;
    mailBody += `ğŸ’ ì´ ì˜ˆìƒ ë“±ê¸° ë¹„ìš©: ${total}\n`;
    mailBody += `----------------------------------------------\n\n`;
    mailBody += `[í•­ëª©ë³„ ìƒì„¸ ë¹„ìš©]\n`;
    mailBody += `- ì·¨ë“ì„¸(êµìœ¡ì„¸ í¬í•¨): ${tax}\n`;
    mailBody += `- ì±„ê¶Œ í• ì¸ë£Œ í•©ê³„: ${bond}\n`;
    mailBody += `- ìˆ˜ì…ì¸ì§€ì„¸ í•©ê³„: ${stamp}\n`;
    mailBody += `- ê¸°íƒ€ ì‹¤ë¹„: 59,000 ì›\n\n`;
    mailBody += `[ìƒì„¸ ì‚°ì¶œ ê·¼ê±°]\n`;
    mailBody += detail + `\n\n`;
    mailBody += `â€» ì°¸ê³ : ë³´ê¸ˆìë¦¬ë¡  ì´ìš© ì‹œ 3ë…„ ë‚´ 0.5% ì¤‘ë„ìƒí™˜ìˆ˜ìˆ˜ë£Œê°€ ë°œìƒí•˜ë©°, ì´ëŠ” ë³´ìœ  ê¸°ê°„ì— ë”°ë¼ ì¼í•  ê³„ì‚°ë˜ì–´ ë°˜ì˜ë©ë‹ˆë‹¤.\n`;

    const subject = encodeURIComponent(`${dong}ë™ ${ho}í˜¸ ë“±ê¸°ë¹„ìš© ê³„ì‚° ë¦¬í¬íŠ¸`);
    const body = encodeURIComponent(mailBody);
    window.location.href = `mailto:?subject=${subject}&body=${body}`;
}

function tglD(){ let e=document.getElementById('tD'); e.style.display=e.style.display==='block'?'none':'block'; }
</script>
</body>
</html>
